,input,query

0,What is the CSG code for category subgroup containing chemical? Also find out the corresponding gl account and its description.,"SELECT B.CSG_Code, G.GL_Account, G.GL_Account_description FROM blue_print_coupa B JOIN gl_account_mapping G ON B.CSG_Code = G.CSG WHERE LOWER(B.Category_Subgroup) LIKE LOWER('%chemical%');"
1,Find buyers for category dairy raw materials! Additionally list in your answer corresponding category subgroups.,"SELECT B.Category_Buyer_EMEA_Coupa, B.Category_Buyer_CPA_Coupa, B.S2C_buyer, B.Category_Subgroup FROM blue_print_coupa B WHERE LOWER(B.Category) LIKE LOWER('%dairy raw materials%');"
2,"Who are the buyers for category subgroup chemical? Also mention Category subgroup, CSG code, GL account and its description, next to the buyers columns.","SELECT B.Category_Buyer_EMEA_Coupa, B.Category_Buyer_CPA_Coupa, B.S2C_buyer, B.Category_Subgroup, B.CSG_Code, G.GL_Account, G.GL_Account_description FROM blue_print_coupa B JOIN gl_account_mapping G ON B.CSG_Code = G.CSG WHERE LOWER(B.Category_Subgroup) LIKE LOWER('%chemical%');"
3,What are the GL account and its corresponding description for category subgroup catering & vending?,"SELECT G.GL_Account, G.GL_Account_description FROM blue_print_coupa B JOIN gl_account_mapping G ON B.CSG_Code = G.CSG WHERE LOWER(B.Category_Subgroup) LIKE LOWER('%catering & vending%');"
4,What are the GL account and its corresponding description for category subgroup water treatment?,"SELECT G.GL_Account, G.GL_Account_description FROM blue_print_coupa B JOIN gl_account_mapping G ON B.CSG_Code = G.CSG WHERE LOWER(B.Category_Subgroup) LIKE LOWER('%water treatment%');"
5,"What are the category, category subgroup and csg code that Alex is the buyer for? Additionally list the corresponding GL account and its description.","SELECT B.Category, B.Category_Subgroup, B.CSG_Code, G.GL_Account, G.GL_Account_description FROM blue_print_coupa B JOIN gl_account_mapping G ON B.CSG_Code = G.CSG WHERE LOWER(B.Category_Buyer_EMEA_Coupa) LIKE LOWER('%alex%') OR LOWER(B.Category_Buyer_CPA_Coupa) LIKE LOWER('%alex%') OR LOWER(B.S2C_buyer) LIKE LOWER('%alex%');"
6,Who is the buyer for category chemicals and category subgroup bulk gas?,"SELECT B.Category_Buyer_EMEA_Coupa, B.Category_Buyer_CPA_Coupa, B.S2C_buyer FROM blue_print_coupa B WHERE LOWER(B.Category) LIKE LOWER('%chemicals%') AND LOWER(B.Category_Subgroup) LIKE LOWER('%bulk gas%');"
7,"Who are the buyers for sub category bulk gas? Additionally list the corresponding category, csg code, gl account and its description.","SELECT B.Category_Buyer_EMEA_Coupa, B.Category_Buyer_CPA_Coupa, B.S2C_buyer, B.Category, B.CSG_Code, G.GL_Account, G.GL_Account_description FROM blue_print_coupa B JOIN gl_account_mapping G ON B.CSG_Code = G.CSG WHERE LOWER(B.Category_Subgroup) LIKE LOWER('%bulk gas%');"
8,List all GL accounts and descriptions for categories containing 'raw materials'.,"SELECT DISTINCT G.GL_Account, G.GL_Account_description FROM blue_print_coupa B JOIN gl_account_mapping G ON B.CSG_Code = G.CSG WHERE LOWER(B.Category) LIKE LOWER('%raw materials%');"
9,Find the GL accounts and descriptions for all category subgroups handled by S2C buyer named 'Alice'.,"SELECT DISTINCT G.GL_Account, G.GL_Account_description FROM blue_print_coupa B JOIN gl_account_mapping G ON B.CSG_Code = G.CSG WHERE LOWER(B.S2C_buyer) LIKE LOWER('%alice%');"
10,How many unique categories are there in the blue_print_coupa table?,SELECT COUNT(DISTINCT Category) FROM blue_print_coupa;
11,Count the number of category subgroups related to water treatment.,SELECT COUNT(*) FROM blue_print_coupa WHERE LOWER(Category_Subgroup) LIKE LOWER('%water treatment%');
12,List all category subgroups and sort them alphabetically.,SELECT Category_Subgroup FROM blue_print_coupa ORDER BY Category_Subgroup;
13,Find the top 5 most common GL accounts and their descriptions.,"SELECT GL_Account, GL_Account_description, COUNT(*) as count FROM gl_account_mapping GROUP BY GL_Account, GL_Account_description ORDER BY count DESC LIMIT 5;"
14,Which categories have more than 10 subgroups?,"SELECT Category, COUNT(Category_Subgroup) as SubgroupCount FROM blue_print_coupa GROUP BY Category HAVING COUNT(Category_Subgroup) > 10;"
15,"List the categories and their corresponding subgroups, sorted by category.","SELECT Category, Category_Subgroup FROM blue_print_coupa ORDER BY Category;"
16,Find all unique categories and count how many subgroups each has.,"SELECT Category, COUNT(Category_Subgroup) as SubgroupCount FROM blue_print_coupa GROUP BY Category;"
17,What is the total number of GL accounts in the gl_account_mapping table?,SELECT COUNT(*) FROM gl_account_mapping;
18,List the top 3 buyers for each category subgroup based on alphabetical order of subgroups.,"SELECT Category_Subgroup, Category_Buyer_EMEA_Coupa, Category_Buyer_CPA_Coupa, S2C_buyer FROM blue_print_coupa ORDER BY Category_Subgroup, Category_Buyer_EMEA_Coupa, Category_Buyer_CPA_Coupa, S2C_buyer LIMIT 3;"
19,Who are the preferred suppliers for sub category engineering services in Thailand?,"SELECT Vendor, Vendor_DESC FROM Supplier_Grid_Plain WHERE LOWER(Category_Subgroup) LIKE LOWER('%Engineering services%') AND LOWER(Country) LIKE LOWER('%Thailand%');"
20,Who are the preferred suppliers for category subgroup Civil works in Vietnam?,"SELECT Vendor, Vendor_DESC FROM Supplier_Grid_Plain WHERE LOWER(Category) LIKE LOWER('%Capex%') AND LOWER(Category_Subgroup) LIKE LOWER('%Civil works%') AND LOWER(Country) LIKE LOWER('%Viet%nam%');"
21,What are the plants in the US?,"SELECT Plant FROM Plant_Country_mapping WHERE LOWER(Country) LIKE LOWER('%United States%') OR LOWER(Country) LIKE LOWER('%US%');"
22,Who are the preffered vendors for the US?,"SELECT Vendor, Vendor_DESC FROM Supplier_Grid_Plain WHERE LOWER(Country) LIKE LOWER('%United States%') OR LOWER(Country) LIKE LOWER('%US%');"
23,Who are the preferred suppliers for sub category mechanical installation in Vietnam? Also list their maturity levels and SAP contract info,"SELECT S.Vendor, S.Maturity_status, S.SAP_Contract FROM Supplier_Grid_Plain S WHERE LOWER(S.Category_Subgroup) LIKE LOWER('%mechanical installation%') AND (LOWER(S.Country) LIKE LOWER('%Viet nam%') OR LOWER(S.Country) LIKE LOWER('%Viet%nam%') OR LOWER(S.Country) LIKE LOWER('%Vietnam%'));"
24,Who are the preferred suppliers for sub category mechanical installation in Malaysia? Also list the corresponding buyers for this sub category.,"SELECT S.Vendor, S.Vendor_DESC, B.Category_Buyer_EMEA_Coupa, B.Category_Buyer_CPA_Coupa, B.S2C_buyer \nFROM Supplier_Grid_Plain S \nJOIN blue_print_coupa B ON S.Category = B.Category AND S.Category_Subgroup = B.Category_Subgroup \nWHERE LOWER(S.Category_Subgroup) LIKE LOWER('%mechanical installation%') AND LOWER(S.Country) LIKE LOWER('%Malaysia%');"
